<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zufallszitat</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
  <header class="bg-indigo-600 text-white p-6 shadow-lg">
    <h1 class="text-3xl font-bold text-center">Zufälliges Zitat</h1>
  </header>

  <main class="flex-grow flex flex-col items-center justify-center p-4">
    <div id="quoteCard" class="max-w-xl bg-white rounded-2xl shadow-lg p-8 text-center">
      <p id="quoteText" class="text-xl italic mb-4">Lade Zitat …</p>
      <p id="quoteAuthor" class="text-lg font-semibold text-indigo-700"></p>
    </div>

    <button id="newQuoteBtn" class="mt-8 px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-2xl shadow-lg transition">
      Neues Zufallszitat
    </button>
  </main>

  <footer class="text-center text-sm text-gray-500 p-4">
    Powered by Netlify Functions &amp; Neon Postgres
  </footer>

  <script>
    const API_URL = '/api/zitate';
    let quotes = [];

    async function fetchQuotes() {
      try {
        const res = await fetch(API_URL);
        quotes = await res.json();
      } catch (err) {
        console.error(err);
        quotes = [];
      }
    }

    function showRandomQuote() {
      if (quotes.length === 0) {
        document.getElementById('quoteText').textContent = 'Keine Zitate gefunden.';
        document.getElementById('quoteAuthor').textContent = '';
        return;
      }
      const { zitat, autor } = quotes[Math.floor(Math.random() * quotes.length)];
      document.getElementById('quoteText').textContent = `“${zitat}”`;
      document.getElementById('quoteAuthor').textContent = `— ${autor}`;
    }

    document.getElementById('newQuoteBtn').addEventListener('click', showRandomQuote);

    // Initial load
    (async () => {
      await fetchQuotes();
      showRandomQuote();
    })();
  </script>
</body>
</html>